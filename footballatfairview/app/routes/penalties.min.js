var List,ObjectId,Penalty,User,UserPenalty,_,isLoggedIn,moment,uuid;List=require("../models/list"),User=require("../models/user"),Penalty=require("../models/penalty"),UserPenalty=require("../models/user_penalty"),moment=require("moment"),uuid=require("node-uuid"),_=require("underscore"),ObjectId=require("mongodb").ObjectID,isLoggedIn=function(e,n,s){return e.isAuthenticated()?s():void n.redirect("/")},module.exports=function(e){return e.get("/penalties",isLoggedIn,function(e,n){n.render("penalties/index.ejs",{message:e.flash("loginMessage"),user:e.user,moment:moment,title:"Penalties"})}),e.get("/penalties/create",isLoggedIn,function(e,n){Penalty.find({},function(s,t){return s?console.log(s):void User.find({},function(s,i){return s?console.log(s):void List.find({list_status:"active"},function(s,o){return s?console.log(s):void n.render("penalties/create.ejs",{message:e.flash("loginMessage"),users:i,penalties:t,matches:o,user:e.user,moment:moment,title:"Penalties"})})})})}),e.post("/penalties/create",function(e,n){var s,t,i,o;o=e.body.player_id,i=e.body.penalty_id,s=e.body.match_id,console.log(o,i,s),t=new UserPenalty({player_id:o,penalty_id:i,match_id:s}),t.save(function(e,s,i){return e?(console.log(e),n.status(422).json({message:e})):void n.json({message:t._id})})}),e.get("/penalties/edit",isLoggedIn,function(e,n){List.find({},function(s,t){return s?console.log(s):void n.render("penalties/edit.ejs",{message:e.flash("loginMessage"),lists:t,user:e.user,moment:moment,title:"Penalties"})})}),e.get("/penalties/view",isLoggedIn,function(e,n){List.find({},function(s,t){return s?console.log(s):void n.render("penalties/view.ejs",{message:e.flash("loginMessage"),lists:t,user:e.user,moment:moment,title:"Penalties"})})})};