var User,isLoggedIn;User=require("../models/user"),isLoggedIn=function(e,r,s){return e.isAuthenticated()?s():void r.redirect("/")},module.exports=function(e){return e.get("/profile",isLoggedIn,function(e,r){r.render("profile/profile.ejs",{user:e.user,title:"Profile"})}),e.post("/profile/edit/phoneNumber",isLoggedIn,function(e,r){var s,i;return s=e.body.phoneNumber,i=e.user.id,User.update({_id:i},{phone:s},function(e,s){return e?{message:e}:s>0?r.send({message:"ok"}):r.send({message:"0 rows affected"})})}),e.get("/profile/view/details",isLoggedIn,function(e,r){r.render("profile/details.ejs"),{message:e.flash("loginMessage"),user:e.user,title:"Profile Details: "+String(e.user.fullname)}})};